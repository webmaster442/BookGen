using Bookgen.Lib.Domain.IO.Configuration;
using Bookgen.Lib.ImageService;

namespace Bookgen.Tests.Lib;

[TestFixture]
internal class UT_ImgService
{
    private EmbeddedTestFileSystem _testFolder;

    [SetUp]
    public void Setup()
    {
        _testFolder = new EmbeddedTestFileSystem();
    }

    [Test]
    public void EnsureThat_SvgPassThroughReturnsExpected()
    {
        var service = new ImgService(_testFolder, new ImageConfig
        {
            ResizeAndRecodeImagesToWebp = false,
            SvgRecode = SvgRecodeOption.Passtrough,
        });

        var result = service.GetImageEmbedData("test.svg");

        string expected = """
            <?xml version="1.0" encoding="UTF-8"?>
            <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
            <svg id="svg2" width="620" height="472" xmlns="http://www.w3.org/2000/svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink">
             <defs id="defs4">
              <path id="box1" d="m0 0h77v210h-77z" stroke="#000" stroke-width="2"/>
              <path id="box2" d="m0 0h77v60h-77z" stroke="#000" stroke-width="2"/>
             </defs>
             <path id="bg" d="m0 0h620v472h-620z" fill="#fff"/>
            <g font-family="DejaVu Sans, Arial, Helvetica" stroke-width="1" xml:space="preserve">
             <g id="g9" transform="translate(2 1)">
              <use id="use11" fill="#fff" xlink:href="#box1"/>
              <use id="use13" x="77" fill="#ff0" xlink:href="#box1"/>
              <use id="use15" x="154" fill="#0ff" xlink:href="#box1"/>
              <use id="use17" x="231" fill="#0f0" xlink:href="#box1"/>
              <use id="use19" x="308" fill="#f0f" xlink:href="#box1"/>
              <use id="use21" x="385" fill="red" xlink:href="#box1"/>
              <use id="use23" x="462" fill="#00f" xlink:href="#box1"/>
              <use id="use25" x="539" xlink:href="#box1"/>
             </g>
             <g id="g45" transform="translate(2 220)">
              <use id="use47" fill="#0f0" xlink:href="#box2"/>
              <use id="use49" x="77" fill="#0f0" xlink:href="#box2"/>
              <use id="use51" x="154" fill="#0f0" xlink:href="#box2"/>
              <use id="use53" x="231" fill="#0f0" xlink:href="#box2"/>
              <use id="use55" x="308" fill="#fff" xlink:href="#box2"/>
              <use id="use57" x="385" fill="#fff" xlink:href="#box2"/>
              <use id="use59" x="462" fill="#fff" xlink:href="#box2"/>
              <use id="use61" x="539" fill="#fff" xlink:href="#box2"/>
              <text id="green100" x="30" y="35" fill="#fff">0.59</text>
             </g>
             <g id="g27" transform="translate(2 280)">
              <use id="use29" fill="red" xlink:href="#box2"/>
              <use id="use31" x="77" fill="red" xlink:href="#box2"/>
              <use id="use33" x="154" fill="#fff" xlink:href="#box2"/>
              <use id="use35" x="231" fill="#fff" xlink:href="#box2"/>
              <use id="use37" x="308" fill="red" xlink:href="#box2"/>
              <use id="use39" x="385" fill="red" xlink:href="#box2"/>
              <use id="use41" x="462" fill="#fff" xlink:href="#box2"/>
              <use id="use43" x="539" fill="#fff" xlink:href="#box2"/>
              <text id="red100" x="20" y="35" fill="#fff">+0.30</text>
             </g>
             <g id="g63" transform="translate(2 340)">
              <use id="use65" fill="#00f" xlink:href="#box2"/>
              <use id="use67" x="77" fill="#fff" xlink:href="#box2"/>
              <use id="use69" x="154" fill="#00f" xlink:href="#box2"/>
              <use id="use71" x="231" fill="#fff" xlink:href="#box2"/>
              <use id="use73" x="308" fill="#00f" xlink:href="#box2"/>
              <use id="use75" x="385" fill="#fff" xlink:href="#box2"/>
              <use id="use77" x="462" fill="#00f" xlink:href="#box2"/>
              <use id="use79" x="539" fill="#fff" xlink:href="#box2"/>
              <text id="blue100" x="20" y="35" fill="#fff">+0.11</text>
             </g>
             <g id="g63" transform="translate(2 410)">
              <use id="grey100" fill="#fff" xlink:href="#box2"/>
              <use id="grey89" x="77" fill="#e3e3e3" xlink:href="#box2"/>
              <use id="grey70" x="154" fill="#b2b2b2" xlink:href="#box2"/>
              <use id="grey59" x="231" fill="#969696" xlink:href="#box2"/>
              <use id="grey41" x="308" fill="#696969" xlink:href="#box2"/>
              <use id="grey30" x="385" fill="#4d4d4d" xlink:href="#box2"/>
              <use id="grey11" x="462" fill="#1c1c1c" xlink:href="#box2"/>
              <use id="grey0" x="539" fill="#000" xlink:href="#box2"/>
              <text id="txgrey100" x="20" y="35">100%</text>
              <text id="txgrey89" x="102" y="35">89%</text>
              <text id="txgrey70" x="179" y="35">70%</text>
              <text id="txgrey59" x="256" y="35">59%</text>
              <text id="txgrey41" x="333" y="35" fill="#fff">41%</text>
              <text id="txgrey30" x="408" y="35" fill="#fff">30%</text>
              <text id="txgrey11" x="487" y="35" fill="#fff">11%</text>
              <text id="txgrey0" x="569" y="35" fill="#fff">0%</text>
             </g>
             <text id="text3446-0" x="90" y="184" fill="#fff" font-size="180" stroke-width="4">TEST</text>
             <text id="text3446" x="80" y="174" stroke-width="4"><tspan id="tspan3448" x="80" y="174" font-size="180">TEST</tspan></text>
            </g>
            </svg>
            """;

        Assert.Multiple(() =>
        {
            Assert.That(result.imageType, Is.EqualTo(ImageType.Svg));
            Assert.That(result.data, Is.EqualTo(expected));
        });
    }

    [Test]
    public void EnsureThat_Svg_Recode_Webp_ReturnsExpected()
    {
        var service = new ImgService(_testFolder, new ImageConfig
        {
            ResizeAndRecodeImagesToWebp = false,
            SvgRecode = SvgRecodeOption.AsWebp,
        });

        var result = service.GetImageEmbedData("test.svg");

        string expected = """
            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
            """;

        Assert.Multiple(() =>
        {
            Assert.That(result.imageType, Is.EqualTo(ImageType.Webp));
            Assert.That(result.data, Is.EqualTo(expected));
        });
    }

    [Test]
    public void EnsureThat_Svg_Recode_Resize_Png_ReturnsExpected()
    {
        var service = new ImgService(_testFolder, new ImageConfig
        {
            ResizeAndRecodeImagesToWebp = false,
            SvgRecode = SvgRecodeOption.AsPng,
            ResizeWith = 200,
            ResizeHeight = 200,
        });

        var result = service.GetImageEmbedData("test.svg");

        string expected = """
            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
            """;

        Assert.Multiple(() =>
        {
            Assert.That(result.imageType, Is.EqualTo(ImageType.Png));
            Assert.That(result.data, Is.EqualTo(expected));
        });
    }

    [Test]
    public void EnsureThat_Png_Passtrough()
    {
        var service = new ImgService(_testFolder, new ImageConfig());

        var result = service.GetImageEmbedData("test.png");

        string expected = """
            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
            """;

        Assert.Multiple(() =>
        {
            Assert.That(result.imageType, Is.EqualTo(ImageType.Png));
            Assert.That(result.data, Is.EqualTo(expected));
        });
    }

    [Test]
    public void EnsureThat_Png_Recode_Webp_Works()
    {
        var service = new ImgService(_testFolder, new ImageConfig
        {
            ResizeAndRecodeImagesToWebp = true,
            ResizeHeight = 100,
            ResizeWith = 200,
            WebpQuality = 80,
        });

        var result = service.GetImageEmbedData("test.png");

        string expected = """
            UklGRk4DAABXRUJQVlA4IEIDAADwGgCdASqFAGQAPm0wlkekIqIhJjFbSIANiWkAFs3+I/5t+KvhH/b653/QfKB7Ev4q/gBxpMhT+Jf7P+k/tVqln6U+sn904w7+mf8X0Yf7j7Zvab+Nf2H/te4R/Fv5Z/v/7J/hO2N+wHsIfrGZMdjsdi0Uqfecy3cJxywDWFUxpt4QT07SH7hp3xBg4MVwsKQDBNPjCwBxkPT7Mp+M/cmIVahhT8UUBswH9ax/+8zu5GBRJMmu+x83dkRVoxZVf29uKgrVeXYF3N6wTzX1kKUsrBE6aEVIlew2Gw2Gw2Gu4AD+/EoAhf+WUVaohvcc9ue1u7xAL/zmPXzb/yi9hL5JYpNthVyF/0OWfT1CDBB+ozpW3SZkOYl/Lwan2HdQE1+TmTOUs4PfRBYWX/7SKx+v44b+vi+pyWBuTLRJA0/fnz/nT5ef/pvos9/HQh/+HvHWH/5X4i++lsmt3MvdTRTvU1hRjsFwEokVtbW8qn1U4hntHzebdjmPKyoq6q4EX4bJW1ts3aaKRfzMTApxNr/zGfICp3aInzd/RggsFAYcUym+dc/8SZACjlOSf3CN8+Ay8TuIBn/xi/E0Wx4qZN+eZnHa948zzs6sg8QzCzHsQ3YUlYpEo7MOm8qFxc0kMI0mpP1EbNa1mmr+Yu+5GtitD3BrWdojpfd3NNQZUlG//m49NxMw2qVNkdxChbkM+w7qAmvuiWnNtRMAs72zJBPiqdCU7Hnt2HIe+rncFpzZAm56rVplDgi73ULaYISCYZBAHgwoRBJiuCjwWAXPiZoSfd8YORfVq9tsQ1dxEwqoGtWDyh9WgAsoNFv3EjvNRGIoEyJ+EWcm/+3DaHG46mHmuMxR8CA9igqKKhejIiwepQHBVWEaVQ8FzidCUFxd6/j5j1bbLecMEWVv1RC0yZ92sl8AGwMfrVn2pOWD0T80/atymFJVzltmqbMswNKU9YVD6pE/fKQ+/AJ1zqD9fCpFmVR404rYPcVDurwlTyDcj4s7AHg2Lm0nYo+JIB0xRzalhq1XQVlqTwtY6ZT+eVIMTCBKUXw/rOG4LP5HfMR7BMrMF7ht5MxJ9P6ahOyC5l52urZAAv/juWY5u3oEAAAAAAA=
            """;

        Assert.Multiple(() =>
        {
            Assert.That(result.imageType, Is.EqualTo(ImageType.Webp));
            Assert.That(result.data, Is.EqualTo(expected));
        });
    }
}
